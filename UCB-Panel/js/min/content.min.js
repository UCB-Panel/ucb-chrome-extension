/*
Author:     UCB-Panel Team
Project:    UCB-Panel
License:    GPL v3
Build date: 14.11.2013 
*/
(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n;a=function(){function a(a,b,c){this.name=a,this.classes=b,this.id=c}return a}(),k=window.navigator.language,m=$.parseJSON($.ajax({url:"_locales/"+k+"/data.json",async:!1,dataType:"json"}).responseText).PanelContent,n=$.parseJSON($.ajax({url:"themes/"+localStorage.fav_theme+".json",async:!1,dataType:"json"}).responseText),e=function(a){var b;return b=$('<button class="'+a.classes+'" type="button" id="'+a.id+'"><div class="'+n.icons[a.name]+'"></div>'+m[a.name].name+"</button><br>"),b.click(function(){return chrome.tabs.create({url:m[a.name].link}),_gaq.push(["_trackEvent",a.id,"clicked"])})},g=function(a){var b;return b=$('<button class="'+a.classes+'" type="button" id="'+a.id+'" data-toggle="tooltip" data-placement="top" title=""'+' data-original-title="'+m[a.name].name+'" >'+'<i class="'+n.icons[a.name]+'"></i >'+"</button>"),b.click(function(){return chrome.tabs.create({url:m[a.name].link}),_gaq.push(["_trackEvent",a.id,"clicked"])})},b=function(a,b,c){var d,f,h,i;for(h=a.length,d=null,f=0,i=[];h>f;)d=a[f],c?$(b).append(g(d)):$(b).append(e(d)),i.push(f++);return i},f=function(a,b,c,d){var e,f;switch(e=null,f=localStorage.fav_theme){case"flat":e=$('<button class="'+a+'" value="'+b+'"><div class="'+c+'"></div>'+d+'<b class="arrow icon-angle-down"></b></button>');break;default:e=$('<button class="'+a+'" value="'+b+'"><div class="'+c+'"></div>'+d+'<div class="icon_arrow"></div></button>')}return e.click(function(){var a,b;return _gaq.push(["_trackEvent","[Collapse Button] "+d,"clicked"]),b=$(this),b.hasClass("trigger_active")?("flat"===f?(a=b.find(".arrow"),a.removeClass("icon-angle-up"),a.addClass("icon-angle-down")):b.find(".icon_arrow").css("background-image","url(images/arrow_down.gif)"),b.next(".ucbPanelCollapseContainer").slideToggle(300),b.removeClass("trigger_active")):(b.find(".trigger_active").next(".ucbPanelCollapseContainer").slideToggle(300),b.find(".trigger_active").removeClass("trigger_active"),"flat"===f?(a=b.find(".arrow"),a.removeClass("icon-angle-down"),a.addClass("icon-angle-up")):b.find(".icon_arrow").css("background-image","url(images/arrow_up.gif)"),b.next(".ucbPanelCollapseContainer").slideToggle(300),b.addClass("trigger_active"))})},c=function(a){return $(a).append("<hr />")},j=function(){return $.get("http://traffic.campus-company.eu/",function(a){var b,c,d,e,f;f=[{name:"credit",regex:/von\s*(\d*)\sMB\spro\sMonat/,group:1,def:"NotFound",fixNumber:!1,toFixed:2,divideBy:1e3,unit:"GB"},{name:"remaining",regex:/Ihr\s*Restguthaben:\s*<strong>\s*(\d*\.\d*)\s*MB/,group:1,def:"NotFound",fixNumber:!1,toFixed:2,divideBy:1e3,unit:"GB"},{name:"upload",regex:/<th>Monatssumme<\/th>\s*<th align=\"right\">((\d*\.)*\d*\,\d*)/,group:1,def:"NotFound",fixNumber:!0,toFixed:2,divideBy:1e3,unit:"GB"},{name:"download",regex:/<th>Monatssumme<\/th>\s*<th align=\"right\">(\d*\.)*\d*\,\d*<\/th>\s*<th align="right">((\d*\.)*\d*\,\d*)/,group:2,def:"NotFound",fixNumber:!0,toFixed:2,divideBy:1e3,unit:"GB"}],a=a.replace(/.*<body>/,""),a=a.replace(/<div[^>]*>.*/,""),d=new Object;for(c in f)e=f[c],b=a.match(e.regex),null!=b?(d[e.name]=b[e.group],void 0!==e.fixNumber&&e.fixNumber&&(d[e.name]=d[e.name].replace(/\./,""),d[e.name]=d[e.name].replace(/\,/,".")),void 0!==e.divideBy&&(d[e.name]/=e.divideBy),void 0!==e.toFixed&&(d[e.name]=parseFloat(d[e.name]).toFixed(e.toFixed)),void 0!==e.unit&&(d[e.name]+=" "+e.unit)):d[e.name]=e.def;return $(".traffic_up").append(d.upload),$(".traffic_down").append(d.download),$(".traffic_total").append(d.remaining)})},h=function(a,b){var c,d,e,f,g;return e=/(<([^>]+)>)/gi,g=a.replace(e,""),f=/(?:[0-9]*(?:[.,][0-9]{2})?|(?:,[0-9]{3})*(?:\.[0-9]{2})?|(?:\.[0-9]{3})*(?:,[0-9]{2})?)[€]/g,c=g.match(f),d=g.replace(f,""),d=d.replace("/",""),null==c&&(c=b?["2,25€","3,65€"]:["2,30€","4,35€"]),d+='<p class="price">Preis: '+c[0]+" &#185; / "+c[1]+" &#178;</p>"},i=function(){return $.get("http://infotv.umwelt-campus.de/mensa/xml/mensa.xml",function(a){var b,c,d,e;return e=$.xml2json(a),$(".ucbMainPanel").slimScroll().bind("slimscroll",function(a,b){return console.log("Position "+b)}),$(".ucbMensaCollapse").click(function(){return chrome.tabs.create({url:"http://ucb.li/mensa"}),_gaq.push(["_trackEvent","[extern] UCB Mensa","clicked"])}),b=$.format.date(new Date,"dd.MM.yyyy"),d=0,c=!1,_.each(e.tag,function(a){return d++,a.datum===b?(c=!0,a.stammessen.match("Feiertag")?$(".ucbMensaCollapse").append('<div class="collapse_item noFood"><span class="glyphicon glyphicon-ban-circle"></span></i> Heute ist ein Feiertag!</div>'):($(".ucbMensaCollapse").append('<div class="collapse_item stammessen"><p class="heading">Stammessen:</p>'+h(a.stammessen)+"</div>"),$(".ucbMensaCollapse").append('<div class="collapse_item vegetarisch"><p class="heading">Vegetarisch:</p>'+h(a.vegetarisch)+"</div>"),$(".ucbMensaCollapse").append('<div class="collapse_item komponentenessen"><p class="heading">Komponentenessen:</p>'+h(a.komponentenessen,!0)+"</div>"),$(".ucbMensaCollapse").append('<div class="info">&#185; für Studierende<br>&#178; für Gäste</p>'))):d>=5&&!c?$(".ucbMensaCollapse").append('<div class="collapse_item noFood"><span class="glyphicon glyphicon-ban-circle"></span></i> Keine Essen gefunden.</div>'):void 0})})},d=function(){var d,e,g,h,k,l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P;return $(".ucbMainPanel").append('<div class="ucbPanelButtonGroup"></div>'),p=".ucbPanelButtonGroup",d="button btn btn-default menuitem-iconic ",e=d+"ucbpanel_iro collapse_item",B=new a("ucbHomepage",e,"[Collapsed] UCB Startseite"),O=new a("ucbTimetable",e,"[Collapsed] UCB Studenplan"),x=new a("ucbDates",e,"[Collapsed] UCB Zeitplan"),r=new a("ucbCampusplan",e,"[Collapsed] UCB Campusplan"),y=new a("ucbExams",e,"[Collapsed] UCB Klausurplan"),v=new a("ucbContact",e,"[Collapsed] UCB Contact"),q=new a("ucbBlog",e,"[Collapsed] UCB Blog"),z=new a("ucbFacebook",e,"[Collapsed] UCB Facebook"),M=new a("ucbStaff",e,"[Collapsed] UCB Personalverzeichnis"),w=new a("ucbDataCenter",e,"[Collapsed] UCB Rechenzentrum"),H=new a("ucbMSDNAA",e,"[Collapsed] UCB MSDNAA"),t=new a("ucbCommunity",d+"ucbpanel_iro","UCB Community"),A=new a("ucbGremienallee",d+"ucbpanel_gremienallee","UCB Gremienallee"),N=new a("ucbStudIP",d+"ucbpanel_studip","UCB Stud.IP"),P=new a("ucbWebMail",d+"ucbpanel_webmail","UCB Webmail"),L=new a("ucbQIS",d+"ucbpanel_qis","UCB QIS"),D=new a("ucbIntranet",d+"ucbpanel_iro","UCB Intranet"),G=new a("ucbLibrary",d+"ucbpanel_bib","UCB eLibrary"),E=new a("ucbJuris",d+"ucbpanel_juris","UCB Juris"),J=new a("ucbOLAT",d+"ucbpanel_olat","UCB OLAT"),I=new a("ucbMensa",d+"ucbpanel_mensa","UCB Mensa"),F=new a("ucbKneipe",d+"ucbpanel_kadu","UCB Campus Kneipe"),$(p).append(f("btn btn-default trigger menuitem-iconic","%COLLAPSE%","icon_ucbpanel_iro","Umwelt-Campus")),$(p).append('<div class="ucbPanelCollapseContainer"></div>'),s=[B,O,x,r,y,v,q,z,M,w,H],b(s,".ucbPanelCollapseContainer"),c(p),u=[t,A],b(u,".ucbPanelButtonGroup"),c(p),C=[N,P,L,D,G,E,J],b(C,".ucbPanelButtonGroup"),c(p),K=[F],b(K,".ucbPanelButtonGroup"),$(p).append(f(d+"ucbpanel_mensa trigger","%COLLAPSE%",n.icons.ucbMensa,"Mensa")),$(p).append('<div class="ucbPanelCollapseContainer ucbMensaCollapse" id="ucbMensaCollapse"></div>'),i(),$.get("http://traffic.campus-company.eu/",function(a){var b,d,e;if(d=a.match(/Ihre IP-Adresse: 143.93.4[0-2]{1}.[0-9]{1,3}/)+"",d=d.replace(/Ihre IP-Adresse: /,"")+"","null"!==d){switch(c(p),e=localStorage.fav_theme){case"flat":b=$('<button class="button btn btn-default menuitem-iconic ucbpanel_traffic" type="button" id="Campus Company Traffic" value="http://traffic.campus-company.eu"><div class="icon-dashboard"></div>Rest-Traffic:&nbsp;<b class="traffic_total"> </b></button>'),b.click(function(){return chrome.tabs.create({url:"http://traffic.campus-company.eu"})}),$(".ucbPanelButtonGroup").append(b);break;default:b=$('<button class="button ucbpanel_traffic" type="button" id="Campus Company Traffic" value="http://traffic.campus-company.eu"></button>'),b.click(function(){return _gaq.push(["_trackEvent","[extern] UCB TrafficMeter","clicked"]),chrome.tabs.create({url:"http://traffic.campus-company.eu"})}),$(".ucbPanelButtonGroup").append(b),$(".ucbPanelButtonGroup").append('<div class="TrafficDisplay"></div>'),$(".TrafficDisplay").append('<div class="TrafficLeftSide"></div>'),$(".TrafficDisplay").append('<div class="TrafficRightSide"></div>'),$(".TrafficLeftSide").append('<p class="traffic_down" type="button" id="Campus Company Traffic"><span class="glyphicon glyphicon-circle-arrow-down"></span> </p>'),$(".TrafficLeftSide").append('<p class="traffic_up" type="button" id="Campus Company Traffic"><span class="glyphicon glyphicon-circle-arrow-up"></span> </p>'),$(".TrafficRightSide").append('<p class="traffic_total" type="button" id="Campus Company Traffic"><span class="glyphicon glyphicon-sort"></span> </p>')}return j()}}),l=$('		<div class="btn-group-wrap" >			<div class="btn-group center FooterInnerClass" >			</div >		</div >	'),$(".ucbPanelFooter").append(l),m=new a("footerHome","btn btn-default","[Footer] Hompage"),g=new a("footerAbout","btn btn-default","[Footer] About"),h=new a("footerBugs","btn btn-default","[Footer] Bugs"),o=new a("footerSettings","btn btn-default","[Footer] Settings"),k=[m,g,h,o],b(k,".FooterInnerClass",!0)},l=function(){var a;return d(),$(".trigger").not(".trigger_active").next(".ucbPanelCollapseContainer").hide(),a=$(this),a.hasClass("trigger_active")||$(".icon_arrow").css("background-image","url(images/arrow_down.gif)"),$(".ucbMainPanel").slimScroll({height:"502px",color:"#666",size:"5px",allowPageScroll:!0,alwaysVisible:!0}),$("#footer").tooltip({selector:"[data-toggle=tooltip]",container:"body"}),$("#footer").tooltip()},l()}).call(this);